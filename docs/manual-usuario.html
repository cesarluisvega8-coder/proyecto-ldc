<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Manual de uso - Solanlyze</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body{ background:#fafafa; }
    .container{ max-width:960px; }
    h1,h2,h3{ color:#1e3a5f; }
    .toc a{ text-decoration:none; }
    @media print{
      .no-print{ display:none !important; }
      body{ background:#fff; }
    }
    code, kbd{ background:#f3f3f3; padding:.15rem .35rem; border-radius:.35rem; }
  </style>
</head>
<body>
  <div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h1 class="h3 mb-0">Manual de uso de la aplicaciÃ³n y GuÃ­a para Assistant (Chatbase)</h1>
      <button class="btn btn-primary no-print" onclick="window.print()">Imprimir / Guardar como PDF</button>
    </div>

    <p>Esta documentaciÃ³n sirve como:<br>
    - Manual para usuarios finales.<br>
    - Base de conocimiento para entrenar un asistente (Chatbase) que responda exclusivamente sobre la app.</p>

    <hr/>

    <h2 id="proposito">1) PropÃ³sito y alcance</h2>
    <ul>
      <li><strong>Objetivo</strong>: Ingresar cargas, definir horarios de uso, calcular energÃ­a/potencia, visualizar curvas (LDC, temporal, heatmap) y exportar resultados.</li>
      <li><strong>Audiencia</strong>: Usuarios que simulan consumos de una vivienda; no requiere conocimientos avanzados.</li>
    </ul>

    <h2 id="estructura">2) Estructura general de la interfaz</h2>
    <ul>
      <li><strong>Carga de datos</strong>: Botones <code>Cargar archivo</code>, <code>Descargar plantilla</code>, <code>Datos de ejemplo</code>. Plantilla: hoja <code>LINEA BASE</code> con columnas <code>Item, Carga, Potencia (W), 0..23</code>.</li>
      <li><strong>Ingreso manual</strong>: Campos <code>Nombre de la carga</code>, <code>Potencia (W)</code>. BotÃ³n <code>Agregar</code> abre el modal de franjas.</li>
      <li><strong>Agregado rÃ¡pido</strong>: Iconos de equipos y panel con <code>Nombre</code> (solo lectura), <code>Potencia</code>, <code>Cantidad</code> y botÃ³n <code>â•</code> que abre el modal de franjas.</li>
      <li><strong>Tabla principal</strong>: Columnas <em>#, Carga, Potencia (W), Horarios, Horas encendido, EnergÃ­a (kWh), AcciÃ³n</em>. Acciones: <code>âœï¸</code> editar rangos, <code>ğŸ—‘</code> eliminar.</li>
      <li><strong>MÃ©tricas</strong>: Valores diarios/mensuales/anuales y selector de periodo.</li>
      <li><strong>Visualizaciones</strong>: Tabs LDC, Mapa de calor y Consumo temporal; exportaciones disponibles.</li>
    </ul>

    <h2 id="flujos">3) Flujos principales</h2>
    <h3>A) Agregar una carga por ingreso manual</h3>
    <ol>
      <li>Completa <code>Nombre de la carga</code> y <code>Potencia (W)</code> en â€œIngreso manualâ€.</li>
      <li>Pulsa <code>Agregar</code> y define franjas en el modal.</li>
      <li>Guarda para ver la fila en la tabla con sus mÃ©tricas.</li>
    </ol>
    <h3>B) Agregar un electrodomÃ©stico rÃ¡pidamente</h3>
    <ol>
      <li>Haz clic en un icono y ajusta <code>Potencia</code> y <code>Cantidad</code>.</li>
      <li>Pulsa <code>â•</code>, define franjas y guarda.</li>
    </ol>
    <h3>C) Editar rangos en la tabla</h3>
    <ol>
      <li>Pulsa <code>âœï¸</code> en la fila deseada.</li>
      <li>Edita las franjas en el modal y guarda.</li>
    </ol>
    <h3>D) Cargar datos desde archivo</h3>
    <ol>
      <li>Usa <code>Cargar archivo</code> con la plantilla <code>LINEA BASE</code>.</li>
      <li>Edita rangos por fila con <code>âœï¸</code> si es necesario.</li>
    </ol>
    <h3>E) Generar mÃ©tricas y visualizar</h3>
    <ol>
      <li>Pulsa <code>Generar mÃ©tricas y grÃ¡ficas</code>.</li>
      <li>Elige periodo (dÃ­a/mes) y, si quieres, un perfil horario.</li>
    </ol>
    <h3>F) Exportar informe PDF</h3>
    <ol>
      <li>Usa el botÃ³n de exportaciÃ³n del informe completo.</li>
      <li>Las grÃ¡ficas se renderizan y se capturan; hay fallback por si faltan.</li>
    </ol>

    <h2 id="componentes">4) Componentes y funcionalidades clave</h2>
    <ul>
      <li><strong>Modal de franjas</strong>: retorna <code>[{inicio, fin}]</code> en horas 0..24.</li>
      <li><strong>EnergÃ­a por rangos</strong>: <code>kWh = (W/1000) * horasTotales</code>.</li>
      <li><strong>Tabla</strong>: muestra rangos como texto; <code>âœï¸</code> reabre el modal; <code>ğŸ—‘</code> elimina.</li>
      <li><strong>GrÃ¡ficas</strong>: LDC, Heatmap y Temporal; â€œPerfil horarioâ€ para filtrar.</li>
      <li><strong>PDF</strong>: fuerza render de grÃ¡ficas y usa <em>fallback</em> cuando es necesario.</li>
    </ul>

    <h2 id="graficas">5) ExplicaciÃ³n de grÃ¡ficas</h2>
    <ul>
      <li><strong>LDC</strong>: potencia ordenada vs duraciÃ³n; identifica picos.</li>
      <li><strong>Mapa de calor</strong>: potencia por hora y por carga.</li>
      <li><strong>Consumo temporal</strong>: evoluciÃ³n agregada en el tiempo.</li>
    </ul>

    <h2 id="mejores-practicas">6) ExportaciÃ³n y mejores prÃ¡cticas</h2>
    <ul>
      <li>Agrega al menos una carga con rangos y pulsa â€œGenerar mÃ©tricas y grÃ¡ficasâ€.</li>
      <li>Si una grÃ¡fica no aparece, visita su tab y reintenta exportar.</li>
    </ul>

    <h2 id="errores">7) Mensajes de error comunes</h2>
    <ul>
      <li>â€œCompleta nombre y potencia.â€ (manual).</li>
      <li>â€œSelecciona un equipo y completa nombre, potencia y cantidad.â€ (rÃ¡pido).</li>
      <li>â€œNo se definieron rangos.â€ (cerraste el modal sin franjas).</li>
      <li>â€œNo se pudo agregar el equipo. Revisa la consola.â€ (error no controlado).</li>
    </ul>

    <h2 id="faq">8) Preguntas frecuentes</h2>
    <ul>
      <li>Â¿CÃ³mo agrego varias franjas? â†’ <code>Agregar</code> o <code>â•</code> y define en el modal.</li>
      <li>Â¿Editar horarios? â†’ BotÃ³n <code>âœï¸</code> en la tabla.</li>
      <li>Â¿QuÃ© es LDC? â†’ Potencia vs duraciÃ³n, ayuda a ver picos.</li>
      <li>Â¿Mapa vacÃ­o? â†’ Genera mÃ©tricas y revisa el tab.</li>
      <li>Â¿Exportar informe? â†’ BotÃ³n de exportaciÃ³n del PDF completo.</li>
      <li>Â¿Cruce de medianoche? â†’ SÃ­, ej. <code>22 â†’ 02</code>.</li>
    </ul>

    <h2 id="assistant">9) Intenciones del asistente (Chatbase)</h2>
    <ul>
      <li>Agregar manual, agregado rÃ¡pido, editar horarios, cargar archivo, explicar grÃ¡ficas, exportar PDF.</li>
      <li>Guardrails: solo temas de la app; no soporte externo; no inventar datos.</li>
      <li>Estilo: breve, pasos numerados, nombres exactos de botones.</li>
    </ul>

    <h2 id="ui">10) Mapa de elementos UI</h2>
    <ul>
      <li><strong>Botones</strong>: Agregar, â•, Cargar archivo, Descargar plantilla, Datos de ejemplo, Generar mÃ©tricas y grÃ¡ficas.</li>
      <li><strong>Campos</strong>: Nombre de la carga, Potencia (W); y en rÃ¡pido Nombre (solo lectura), Potencia, Cantidad.</li>
      <li><strong>Tabla</strong>: âœï¸ editar rangos, ğŸ—‘ eliminar.</li>
      <li><strong>GrÃ¡ficas</strong>: LDC, Mapa de calor, Consumo temporal.</li>
    </ul>

    <h2 id="datos">11) Estructura de datos clave</h2>
    <p><code>{ Carga, Potencia_W, Rangos:[{inicio,fin}], HorasEncendido, Energia_kWh }</code></p>

    <h2 id="troubleshooting">12) Troubleshooting</h2>
    <ul>
      <li><strong>â• no abre modal</strong>: selecciona icono, completa Potencia y Cantidad. Ver consola.</li>
      <li><strong>PDF sin grÃ¡ficas</strong>: la app fuerza render y fallback; visita los tabs y reintenta.</li>
    </ul>

    <h2 id="branding">13) ExportaciÃ³n y branding (opcional)</h2>
    <ul>
      <li>Logo/colores en PDF: ajustar en <code>js/mainApp.js</code>.</li>
      <li>Fuentes: se puede incrustar una fuente con jsPDF.</li>
    </ul>

    <h2 id="glosario">14) Glosario</h2>
    <ul>
      <li><strong>Rango horario</strong>: <code>inicio â†’ fin</code> (0..24).</li>
      <li><strong>LDC</strong>: curva de duraciÃ³n de carga.</li>
      <li><strong>kWh</strong>: kilovatio-hora.</li>
    </ul>

    <hr/>
    <div class="text-muted">VersiÃ³n del manual: 1.0</div>
  </div>
</body>
</html>
